{% extends "base.html" %}
{% block title %}{{ course.title }}{% endblock %}
{% block content %}
<h1>{{ course.title }}</h1>
{% if course.instructor %}<p><strong>Instructor:</strong> {{ course.instructor }}</p>{% endif %}
{% if course.start_date %}<p><strong>Start:</strong> {{ course.start_date }}</p>{% endif %}
{% if course.end_date %}<p><strong>End:</strong> {{ course.end_date }}</p>{% endif %}
{% if course.capacity %}<p><strong>Capacity:</strong> {{ course.capacity }} | Enrolled: {{ course.enrollments.count }}</p>{% endif %}
<p>{{ course.description|linebreaks }}</p>

{% if user.is_authenticated %}
    <form method="post">
        {% csrf_token %}
        {% if is_enrolled %}
            <button type="submit" name="action" value="unenroll">Unenroll</button>
        {% else %}
            <button type="submit" name="action" value="enroll">Enroll</button>
        {% endif %}
    </form>
{% else %}
    <p><a href="{% url 'login' %}?next={{ request.path }}">Log in</a> to enroll.</p>
{% endif %}

{% if user.is_staff %}
    <p>
        <a role="button" href="{% url 'course_edit' course.pk %}">Edit</a>
        <form method="post" action="{% url 'course_delete' course.pk %}" style="display:inline;">
            {% csrf_token %}
            <button type="submit">Delete</button>
        </form>
    </p>
{% endif %}
{% endblock %}
